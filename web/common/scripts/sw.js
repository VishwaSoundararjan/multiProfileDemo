!function(){"use strict";const t="https://sdk.resu.io/Campaign",e=e=>{let n="";return n=t,n+e};var n,a={},s={},o="false",i="",d=null;function c(t){return new Promise((function(e,a){try{let s=indexedDB.open("resuldata",1);s.onsuccess=function(){try{n=s.result;try{n.objectStoreNames.contains("Res_Data")||n.createObjectStore("Res_Data",{keyPath:"key"})}catch(t){}var o=n.transaction(["Res_Data"]).objectStore("Res_Data").get(btoa(t));o.onsuccess=function(t){let n=o.result.value;try{n=JSON.parse(atob(atob(n))),e(n)}catch(t){a(t)}},o.onerror=function(t){a(t)}}catch(t){a(t)}}}catch(t){a(t)}}))}addEventListener("fetch",(t=>{t.waitUntil(void(t.clientId&&clients.get(t.clientId).then((t=>{t&&("true"==o&&(t.postMessage({msg:s}),self.clients.matchAll({includeUncontrolled:!0,type:"window"}).then((function(t){t&&t.length&&t[0].postMessage({msg:s})}))),i&&t.postMessage({pass_id:i}))}))))})),self.addEventListener("install",(function(t){self.skipWaiting()})),self.addEventListener("activate",(function(t){t.waitUntil(self.clients.claim())})),self.addEventListener("message",(t=>{let n=null;try{self.clients.matchAll({includeUncontrolled:!0,type:"window"}).then((function(t){n=t}))}catch(t){}if("event"in t.data){if("ping"==t.data.event)try{self.clients.matchAll({includeUncontrolled:!0,type:"window"}).then((function(t){t&&t.length&&t[0].postMessage({ping:"success"})}))}catch(t){}if("customEventTest"==t.data.event){const e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.data.payload||t.data.data)};fetch("https://sdklb13.resu.io/Campaign/customeventstest",e).then((t=>t.json())).then((t=>{}))}if("resu_post"==t.data.event){const e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.data.data.payload)};fetch(t.data.data.url,e).then((t=>t.json())).then((t=>{}))}if("customEvent"==t.data.event)Promise.all([c("Res_Passport_Id"),c("Res_Profile_Id"),c("_tenantId"),c("deviceId")]).then((n=>{try{const a={...t.data.payload,passportId:n[0]||"",profileID:n[1]||"",tenantId:n[2]||"",deviceId:n[3]||""},s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)};fetch(e("/CustomEvents"),s).then((t=>t.json())).then((t=>{}))}catch(t){}}));else if("userRegisterEvent"==t.data.event){const n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.data.payload)};fetch(e("/UserRegister"),n).then((t=>t.json())).then((t=>{"success"!=t.data&&t.data&&(i=t.data,d=setInterval((()=>{try{self.clients.matchAll({includeUncontrolled:!0,type:"window"}).then((function(t){t&&t.length&&t[0].postMessage({pass_id:i})}))}catch(t){}}),2e3),setTimeout((()=>{clearInterval(d)}),2e4))}))}else if("userJourney"==t.data.event){const n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.data.payload)};fetch(e("/UserJourney"),n).then((t=>t.json())).then((t=>{}))}else"customMsgEvent"==t.data.event?(a=t,t.data,t.data.data.id,representNotification(a)):"dismissInapp"==t.data.event?(console.log("dismissInapp tapped"),o="false",s={}):"notificationqueue"==t.data.event?(console.log("notificationqueue",t.data.payload.data),showBgNotification(t.data.payload)):"checkSession"==t.data.event?self.registration.showNotification("session closed!"):"clear_pass_id"==t.data.event?(i="",clearInterval(d)):"dismiss_TBN"==t.data.event&&self.clients.matchAll({includeUncontrolled:!0,type:"window"}).then((function(t){t&&t.length&&(t[0].postMessage({event:"dismiss_TBN_tapped"}),n[0].postMessage({event:"dismiss_TBN_tapped"}))}))}}))}();